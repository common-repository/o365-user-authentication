=== Office 365 User Authentication for WordPress ===
Contributors: wpintegrate
Donate link: https://wpintegrate.com/
Tags: authentication login, azure active directory sso, office 365, dynamics crm, sharepoint
Requires at least: 3.5.2
Tested up to: 6.3.2
Requires PHP: 5.6.36
Tested up to PHP: 8.2.4
Stable tag: 2.6
License: GPLv2 or later
License URI: http://www.gnu.org/licenses/gpl-2.0.html

== Description ==

“If you want to keep your login information safe and secure, while  easily accessible by the authorised personnel then this is the plugin for you!. Office 365 AAD User Authentication plugin is used to Authenticate an Azure Active Directory(AAD) user/Office 365 user against a WordPress website, which results in the user being logged into the WordPress website. 


<h3>Office 365 User Authentication for WP plugin provide these features:</h3>

* Azure AD user is able to log into a WordPress website as subscriber WordPress user role. 
* Login via Azure Active Directory
* Automatic user registration after login if the user is not already registered with your site. 
* Use Basic Attribute Mapping feature to map WordPress user profile attributes like First Name, Last Name to the attributes provided by your IDP. 
* Used Basic WordPress role mapping to the subscriber role. 
* Force authentication with your IDP on each login attempt. 
* SAML Single Logout – Support for SAML Single Logout (Works only if your IDP supports SLO). 
* Auto-redirect to IDP – Auto-redirect to your IDP for authentication without showing them your WordPress site’s login page. This is enabled via the use of our free [Intranet and Extranet with O365 Login](https://wordpress.org/plugins/o365-wp-restrict/) plugin. 
* Protect Site – Protect your complete site. Have users authenticate themselves before they could access your site content. This is enabled via the use of our free [Intranet and Extranet with O365 Login](https://wordpress.org/plugins/o365-wp-restrict/) plugin.  
* Short Code – Use Short Code (PHP or HTML) to place the login link wherever you want on the site. 
* Step-by-step Guides – Use step-by-step guide to configure your Identity Provider like ADFS. 
* WordPress Multi-site Support. 


<h3> <a href="https://wpintegrate.com/product/azure-ad-user-authentication-wordpress/">PREMIUM</a> FEATURES: </h3>
<h5> The <a href="https://wpintegrate.com/product/azure-ad-user-authentication-wordpress/"> premium </a> version of the plugin offers all of the above, plus: </h5>
* Create and update unlimited Azure Ad/Office 365 users. 
* Support for (granting customers, partners etc. access to your (extranet) website. 
* The ability to quickly rollout thousands of new users to WordPress from Azure Active Directory. This is enabled via our [Azure Ad/Office 365 user registration and synchronization](https://wpintegrate.com/product/azure-ad-and-office-365-user-synchronization-and-registration-for-wordpress/) solution.  
* Support for Muliti-tenant authentication.  
* Support for Azure AD Guest and Member user types authentication into WordPress. Ideal for the implementation of [SharePoint](https://wpintegrate.com/product/sharepoint-search-with-list-and-document-display-for-wordpress/) and [Dynamics CRM 365](https://wpintegrate.com/product/dynamics-crm-display-for-wordpress/) portals in WordPress.  
* Log out users from Office 365 when they log out from your WordPress website. 
* Enhanced security features e.g. Brute Force Attacks prevention
* Support the mapping of Azure Ad/Office 365 data to user fields created by Buddypress Xprofile,  Toolset Type, Advanced Custom Field (ACF) via an intuitive user interface. 
* Enhances a user’s WordPress profile with information from Azure Ad and Microsoft Graph e.g. office location, job title, mobile and business phone numbers 
* Replaces default WordPress avatar for a user with the Azure Ad or Office 365 (O365) profile picture and placed it into the media library. 
* Access Control based on users being a members of either an Office 365 or an Azure AD Security group 
* Automated WordPress Role Assignment based on a configurable mapping between Office 365 or Azure AD Security groups and WordPress roles 

https://www.youtube.com/watch?v=sjWOKeVJ1kM

https://www.youtube.com/watch?v=JF-2tthUx08

<h3>PREREQUISITES </h3>
* Wordpress with Admin Access 
* The wpintegrate.com [office 365 base plugin](https://wpintegrate.com/custom/o365.zip) to enable a connection with your tenant azure ad environment  
* Office 365 Account with Global Administrator role 
* Apache web server on Linux or Unix based hosting 
* (Optional) To support further restriction of your Wordpress website for intranet or extranet scenarios, consider using the free [Intranet and Extranet with O365 Login](https://wordpress.org/plugins/o365-wp-restrict/)  
 
<h3>SUPPORT </h3>
We would be happy to assist if you have questions or if the plugin doesn't work for you as expected. Go to [Support Webform](https://wpintegrate.com/contact-us/).  


<h3>Our Suite of Office 365 Plugins</h3>
* [Office 365 Video Display for WordPress](https://wpintegrate.com/product/office-365-video-display-for-wordpress/)
The “Office 365 Video Display for WordPress” plugin is used to showcase videos from the SharePoint online’s video hub portal “https://[your-tenant].sharepoint.com/portals/hub/” in your WordPress website.  Support list or single display of videos in WordPress, based on channel ids and video ids. 
* [Sharepoint Calendar Display for WordPress](https://wpintegrate.com/product/sharepoint-calendar-display-for-wordpress/)
The “SharePoint Calendar Display for WordPress” plugin is used to show calendar events from the SharePoint calendar list type from SharePoint online in WordPress. The display types are calendar view via the full calendar javascript plugin, grid view and carousel view. We have created a shortcode with several configuration options to achieve this functionality.
* [Onedrive for Business Display for WordPress](https://wpintegrate.com/product/onedrive-for-business-display-for-wordpress/)
The “OneDrive for Business Display for WordPress” plugin is used to show OneDrive for business files and folders online in WordPress. The display types are grid view and list view.
We have created a shortcode with several configuration options to achieve this functionality.
* [Outlook Calendar Display for WordPress](https://wpintegrate.com/product/outlook-calendar-display-for-wordpress/)
The “Outlook Calendar Display for WordPress” plugin is used to show calendar events from the Outlook calendar from Office 365 in WordPress. The display types are calendar view via the full calendar JavaScript plugin, grid view and carousel view.
* [Azure AD B2C User Authentication for WordPress](https://wpintegrate.com/product/azure-ad-b2c-user-authentication-for-wordpress/)
Office 365 AAD B2C User Authentication plugin is used to Authenticate an Azure Active Directory(AAD) B2C user against a WordPress website, which results in the user being logged into the WordPress website.
* [Dynamic CRM 365 Display for WordPress](https://wpintegrate.com/product/dynamics-crm-display-for-wordpress/)
The “Dynamic CRM 365 Display for WordPress” plugin is used to show Dynamics CRM 365 entities from Office 365 in WordPress. Define a custom template or use several that we provided to customize the look and feel of your displays.
* [Azure AD and Office 365 User Authentication for WordPress](https://wpintegrate.com/product/azure-ad-user-authentication-wordpress/)
Office 365 AAD User Authentication plugin is used to verify users seamlessly and securely. This means no more having to remember usernames or passwords,making the process of logging in simple, easy and quick.
* [SharePoint Search with List and Document Display for WordPress](https://wpintegrate.com/product/sharepoint-search-with-list-and-document-display-for-wordpress/)
The “SharePoint Search Display for WordPress” plugin is used to show SharePoint search results from SharePoint online in WordPress. The display types are grid view, faceted search view, and list view.
* [Powerapps for WordPress](https://wpintegrate.com/product/powerapps-for-wordpress/)
Powerapps for WordPress is a plugin that allows you to easily add your own custom bulk actions to your admin panel on the posts, custom post types, woocommerce, events(the event calendar plugin), BuddyPress, pages, media and users overviews. Which, on activation will pass the data of the selected records as parameters to the powerapps application for processing.
* [PowerBi for WordPress](https://wpintegrate.com/product/powerbi-for-wordpress/)
We provide solutions and technical expertise to allow your WordPress data and website to work with PowerBi. Power BI is a suite of cloud-based business analytics tools to analyze data and share insights. Monitor your business and get answers quickly with rich dashboards available on every device.
* [Azure AD and Office 365 User Synchronization and Registration for WordPress](https://wpintegrate.com/product/azure-ad-and-office-365-user-synchronization-and-registration-for-wordpress/)
Synchronize users from Office 365 to WordPress (BuddyPress, Woocommerce, Memberpress) incl. Azure AD custom fields, avatar, Group Membership and user invitation.
* [Azure ADB2C and Office 365 User Synchronization and Registration for WordPress](https://wpintegrate.com/product/azure-adb2c-and-office-365-user-synchronization-and-registration-for-wordpress/)
Synchronize users from Azure ADB2C to WordPress (BuddyPress, Woocommerce, Memberpress) incl. Azure ADB2C custom fields, avatar, Group Membership and user invitation.
* [Microsoft Bookings for WordPress](https://wpintegrate.com/product/microsoft-bookings-for-wordpress/)
The Microsoft Bookings for WordPress plugin is used to provide a customizable and streamlined booking experience for customers with the Microsoft Booking service acting as the backend and data source. We added support for payments. 
Microsoft Bookings is an online and mobile app for small businesses who provide services to customers on an appointment basis. Examples of businesses include hair salons, dental offices, spas, law firms, financial services providers, consultants, and auto shops.
* [Bookly Rest API CRED Operations](https://wpintegrate.com/product/bookly-cred-rest-api-operations/)
We created the “Bookly CRED Rest API Operations” addon to allow users to create, update and delete appointments, staff, services and customers data created with the Bookly plugin from anywhere. In it’s most basic form, a rest api separates the content from its presentation, freeing developers and users to use their data as they would like. The rest api is provided in a simple to use and understand json format.
* [Microsoft 365 Office Add-ins](https://wpintegrate.com/product/microsoft-office-365-office-add-ins/)
Office 365 Office Add-ins with Powerapps is a plugin that allows you to easily host or create an office 365 add-ins xml manifest, that implements a specific powerapps that is displayed in the context of an office 365 service – example outlook mail application. The XML manifest file of an Office Add-in describes how your add-in should be activated when an end user installs and uses it with Office documents and applications.
* [Microsoft Teams for WordPress](https://wpintegrate.com/product/microsoft-teams-wordpress/)
Microsoft Teams enables you to get all your content, tools and conversations in the Team workspace within Office 365.
Microsoft Teams for WordPress is used to create WordPress pages as Microsoft Teams Tabs and Apps as well as sending WordPress data(events, orders etc) to a Teams channel formatted as a specific adaptive card. This is achieved by using one or more of our plugins for (custom post type, woo-commerce, user and forms(gravity form, contact 7 and ninja forms)) to interface with the Microsoft Teams Rest APIs.
* [Office 365 Microsoft Search Display for WordPress](https://wpintegrate.com/product/office-365-microsoft-search-display-for-wordpress/)
The “Office 365 Microsoft Search Display for WordPress” plugin is used to show indexed results from the supported connectors(SharePoint, outlook, etc) from Office 365 in WordPress. The display type currently available is a list view. 
* [Office 365 Persons Display for WordPress](https://wpintegrate.com/product/office-365-persons-display-for-wordpress/)
The “Office 365 Persons Display for WordPress” plugin is used to show Office 365/Azure AD users and Outlook contacts in WordPress. The display types are list/accordion and grid view.
We have created a shortcode with several configuration options to achieve this functionality.
* [Office 365 Yammer Display for WordPress](https://wpintegrate.com/product/office-365-yammer-display-for-wordpress/)
The “Office 365 Yammer Display for WordPress” plugin is used to show Office 365 Yammer groups and topics in WordPress. The display types are single and grid view.
* [Outlook Calendar Room and Resource Booking for WordPress](https://wpintegrate.com/product/outlook-calendar-room-and-resource-booking-for-wordpress/)
The “Outlook Calendar Room and Resource Booking for WordPress” plugin is used to reserve rooms or resources within an organization.
If you have a conference room, company car, or equipment that everyone needs to use, then you need to come up with a way to make those resources reservable to everyone. The best way to do that is to create a room or equipment mailbox in Microsoft 365 for each resource. You might create one for your first floor conference room, media equipment, or a moving truck.
* [Sharepoint Calendar Room and Resource Booking for WordPress](https://wpintegrate.com/product/sharepoint-calendar-room-and-resource-booking-for-wordpress/)
The “Sharepoint Calendar Room and Resource Booking for WordPress” plugin is used to reserve rooms or resources within an organization.
If you have a conference room, company car, or equipment that everyone needs to use, then you need to come up with a way to make those resources reservable to everyone. The best way to do that is to create a room or equipment mailbox in Microsoft 365 for each resource. You might create one for your first floor conference room, media equipment, or a moving truck.

<h3> Our Suite of Rest APIs, Web hook and Trigger based Plugins </h3>

* <a href="https://wpintegrate.com/product/webhooks-and-rest-api-manager-events/">Webhooks and REST API Manager – Events</a> <br/>
The Webhooks and REST API Manager – Events is a WordPress plugin used to add support for “the events calendar” and “the events calendar pro“ plugin, in varying integration scenarios.

* <a href="https://wpintegrate.com/product/webhooks-and-rest-api-manager-media/">Webhooks and REST API Manager – Media </a> <br/>
The Webhooks and REST API Manager – Media is a WordPress plugin used to add support for media type in varying integration scenarios

* <a href="https://wpintegrate.com/product/webhooks-and-rest-api-manager-posts/">Webhooks and REST API Manager – Posts </a> <br/>
The Webhooks and REST API Manager – Posts and Page is a WordPress plugin used to add support for post types in varying integration scenarios.
The custom field plugins that are supported for posts, pages, or custom post types are:
Advanced Custom Fields Pro, Advanced Custom Fields (Free), WordPress’s own, default custom fields, Toolset Types

* <a href="https://wpintegrate.com/product/webhooks-and-rest-api-manager-users/">Webhooks and REST API Manager – Users</a> <br/>
The Webhooks and REST API Manager – Users is a WordPress plugin used to add support for the WordPress user meta values, user roles, buddypress xprofile meta, Advanced Custom Fields Pro, Advanced Custom Fields (Free), WordPress’s own, default custom fields and Toolset Types.
* <a href="https://wpintegrate.com/product/webhooks-and-rest-api-manager-woocommerce/">Webhooks and REST API Manager – Woocommerce </a> <br/>
The Webhooks and REST API Manager – Woocommerce is a WordPress plugin used to add support for woocommerce in varying integration scenarios

* <a href="https://wpintegrate.com/product/webhooks-and-rest-api-manager-bulk-actions/">Webhooks and REST API Manager – Bulk Actions</a>
Webhooks and REST API Manager – Bulk Actions is a WordPress plugin that allows you to easily add your own custom bulk actions to your admin panel on the posts, custom post types, woocommerce, events(the event calendar plugin), BuddyPress, pages, media and users overviews. Which, on activation will 1) immediately send an Http Call via webhooks to an external service with JSON data specific to the records selected for bulk action or 2) Add interactivity to your submission before it is sent to the external service, this interaction can be in the form of a text field, textarea, file or image data. Each configured interaction can be saved for future usage. Such external services include Zapier.com, Ifttt.com, Integromat.com and Microsoft flow.

* <a href="https://wpintegrate.com/product/webhooks-and-rest-api-manager-forms/">Webhooks and REST API Manager – Forms</a>
The Webhooks and REST API Manager – Forms is a WordPress plugin used to add support for gravity forms, contact 7 form, formcraft pro and ninja forms with added support for the uploading of single or multiple files in varying integration scenarios.

* <a href="https://wpintegrate.com/product/webhooks-and-rest-api-manager-buddypress/">Webhooks and REST API Manager – BuddyPress </a> <br/>
The Webhooks and REST API Manager – BuddyPress  is a WordPress plugin used to add support for “Buddypress/BbPress” plugins, in varying integration scenarios.


== Installation ==

<h1>Installation Process</h1>
1. Upload the plugin files to the **/wp-content/plugins** directory, or install the plugin through the WordPress plugins screen  
directly.
2. Before activate the plugin you need install the office365 base plugin.
 [Click here](https://wpintegrate.com/custom/o365.zip) to download the base plugin.
3. Activate the base plugin through the **Plugins** screen in WordPress.
4. After activate base plugin from your WordPress admin menu go to **Office 365** >> **Settings** then under the **General** tab.  
Fill in the Application ID, Application Key and Tenant Name with the app registration details taken from the section **Register  
an application in Azure Active directory for WordPress** above.
5. Click on the **Save Setting and get authentication** button, to have the plugin verified. If successful a green text with  
**This plugin has been verified**, will become visible.
6. Now activate this authentication plugin through the **Plugins** screen in WordPress.
7. After activate this plugin from your WordPress admin menu go to **Office 365** >> **Settings** then under the **user** tab 
fill details as your needs.

== Screenshots ==

1. /assets/screenshot-1.png
2. /assets/screenshot-2.png
3. /assets/screenshot-3.png

== Changelog ==

= 1.0 =
* Initial Release

= 1.1 = 
Minor Bugs Fixes

= 1.2 = 
Added option to add image as login link

= 1.3 =
Added option to style the login link

= 1.4 = 
Make it compatible to PHP 7 and WordPress 5.2.4

= 1.5 = 
Added option for Redirect after login

= 2.0 = 
Updated azure endpoint with Graph APIs

== Upgrade Notice ==

= 1.0 =
Upgrade notices describe the reason a user should upgrade.

== Frequently Asked Questions ==

= How to Create Azure Application =

<h1>Register an application in Azure Active directory for WordPress</h1>
<h3>What is an Azure Active directory application registration? </h3>
<p>A Microsoft Azure active directory application registration provides the permissions needed to access office365 and Azure  
service resources using its REST APIs.</p>

1. Sign in to the Azure portal at https://aad.portal.azure.com/ – Please login in with your Office 365 administrator account,  
this user should have the role of **Global administrator** in office 365. This can be verified at  
https://portal.office.com/adminportal/home#/users
2. While logged into the Azure portal go to the menu item on the left for "Azure Active directory". On the same left, you will  
see a sub menu specific for azure active directory, click on the menu option for "App Registration" or via [this link]  
(https://aad.portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/RegisteredApps)
3. In the upper left of the blade/panel to the right, click on the option for "New Application registration".
4. In the "Create" blade/panel – Add a "Name", keep the "Application Type" as "Web app/API" and make the "Sign-on Url" "YOUR  
DOMAIN NAME /wp-admin/admin.php?page=o365_settings"
5. After saving/creating the app, you can search by name for the said app, so it can be modified further.
6. Under Settings >> Reply URLs – You should have two URLs: "YOUR DOMAIN NAME/wp-admin" and "YOUR DOMAIN NAME/wp- 
admin/admin.php?page=o365_settings"
6. Under Settings >> Required Permissions – To initially verify the base plugin – Enable Access for the default API  
"Microsoft.Azure.ActiveDirectory" so that it has, ALL "Application Permissions" and "Delegated Permissions" enabled and saved.
8. Under Settings >> Keys – create an application key by providing details for “Description” and choosing an appropriate  
"Expires" time frame, then Save and Copy the key value. You won’t be able to retrieve it after you leave the blade.
9. To get the Tenant Name needed to complete the plugin setup go to – Azure Active Directory >> Domain names or directly at  
https://aad.portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Domains, the Tenant Name, is the prefix section of  
the Microsoft specific subdomains example: “myTenantName” taken from myTenantName.onmicrosoft.com or myTenantName.sharepoint.com.

<p> You can check steps with screenshots to create application in <a href="https://wpintegrate.com/kb-article/azure-active-directory-application-registration-configuration/"> Azure portal from here</a> and check application <a href="https://wpintegrate.com/kb-article/azure-ad-and-office-365-user-authentication-for-wordpress-app-permission/">permission for user auth plugin from here</a>.</p>
